#include "../includes/Server.hpp"

string Server::defaultFile(string directory) const
{
	map<string, Location> locations = config.getLocations();
	map<string, Location>::const_iterator location = locations.find(directory);
	if (location != locations.end())
		return location->second.getDefaultFile();
	return "";
}

void Server::init()
{
	listenFD = socket(AF_INET, SOCK_STREAM, 0);
	if (-1 == listenFD)
		throw ServerConnectionException("Can't create socket");
	
	int reuse = 1;
	if (setsockopt(listenFD, SOL_SOCKET, SO_REUSEADDR, (void *)&reuse, sizeof(int)) < 0)
		throw ServerConnectionException("Can't set socket options");

	memset(&sockaddr, 0, sizeof(sockaddr));
	sockaddr.sin_family = AF_INET;
	sockaddr.sin_addr.s_addr = htonl(INADDR_ANY);
	sockaddr.sin_port = htons(config.getPort());

	if (-1 == bind(listenFD, (struct sockaddr *)&sockaddr, sizeof(sockaddr)))
		throw ServerConnectionException("Can't bind");

	if (-1 == listen(listenFD, 5))
		throw ServerConnectionException("Can't listen");
	
	initResources();
}

string Server::errorFile(int code) const
{
	map<int, string> errors = config.getErrorPages();
	map<int, string>::iterator it = errors.find(code);
	if (it != errors.end())
		return it->second;
	return "";
}

void Server::initResources()
{
	statusCodes[100] = "Continue";
	statusCodes[200] = "OK";
	statusCodes[201] = "Created";
	statusCodes[204] = "No Content";
	statusCodes[301] = "Moved Permanently";
	statusCodes[400] = "Bad Request";
	statusCodes[403] = "Forbidden";
	statusCodes[404] = "Not Found";
	statusCodes[405] = "Method Not Allowed";
	statusCodes[411] = "Length Required";
	statusCodes[413] = "Content Too Large";

	mimeTypes[".123"] = "application/vnd.lotus-1-2-3";
	mimeTypes[".3dml"] = "text/vnd.in3d.3dml";
	mimeTypes[".3ds"] = "image/x-3ds";
	mimeTypes[".3g2"] = "video/3gpp2";
	mimeTypes[".3gp"] = "video/3gpp";
	mimeTypes[".3gpp"] = "audio/3gpp";
	mimeTypes[".3gpp2"] = "audio/3gpp2";
	mimeTypes[".7z"] = "application/x-7z-compressed";
	mimeTypes[".a"] = "application/octet-stream";
	mimeTypes[".aab"] = "application/x-authorware-bin";
	mimeTypes[".aac"] = "audio/x-aac";
	mimeTypes[".aam"] = "application/x-authorware-map";
	mimeTypes[".aas"] = "application/x-authorware-seg";
	mimeTypes[".abw"] = "application/x-abiword";
	mimeTypes[".ac"] = "application/pkix-attr-cert";
	mimeTypes[".acc"] = "application/vnd.americandynamics.acc";
	mimeTypes[".ace"] = "application/x-ace-compressed";
	mimeTypes[".acu"] = "application/vnd.acucobol";
	mimeTypes[".acutc"] = "application/vnd.acucorp";
	mimeTypes[".adp"] = "audio/adpcm";
	mimeTypes[".adts"] = "audio/aac";
	mimeTypes[".aep"] = "application/vnd.audiograph";
	mimeTypes[".afm"] = "application/x-font-type1";
	mimeTypes[".afp"] = "application/vnd.ibm.modcap";
	mimeTypes[".ahead"] = "application/vnd.ahead.space";
	mimeTypes[".ai"] = "application/postscript";
	mimeTypes[".aif"] = "audio/x-aiff";
	mimeTypes[".aifc"] = "audio/x-aiff";
	mimeTypes[".aiff"] = "audio/x-aiff";
	mimeTypes[".air"] = "application/vnd.adobe.air-application-installer-package+zip";
	mimeTypes[".ait"] = "application/vnd.dvb.ait";
	mimeTypes[".ami"] = "application/vnd.amiga.ami";
	mimeTypes[".apk"] = "application/vnd.android.package-archive";
	mimeTypes[".appcache"] = "text/cache-manifest";
	mimeTypes[".application"] = "application/x-ms-application";
	mimeTypes[".apr"] = "application/vnd.lotus-approach";
	mimeTypes[".arc"] = "application/x-freearc";
	mimeTypes[".asc"] = "application/pgp-signature";
	mimeTypes[".asf"] = "video/x-ms-asf";
	mimeTypes[".asm"] = "text/x-asm";
	mimeTypes[".aso"] = "application/vnd.accpac.simply.aso";
	mimeTypes[".ass"] = "audio/aac";
	mimeTypes[".asx"] = "video/x-ms-asf";
	mimeTypes[".atc"] = "application/vnd.acucorp";
	mimeTypes[".atom"] = "application/atom+xml";
	mimeTypes[".atomcat"] = "application/atomcat+xml";
	mimeTypes[".atomsvc"] = "application/atomsvc+xml";
	mimeTypes[".atx"] = "application/vnd.antix.game-component";
	mimeTypes[".au"] = "audio/basic";
	mimeTypes[".avi"] = "video/x-msvideo";
	mimeTypes[".avif"] = "image/avif";
	mimeTypes[".aw"] = "application/applixware";
	mimeTypes[".azf"] = "application/vnd.airzip.filesecure.azf";
	mimeTypes[".azs"] = "application/vnd.airzip.filesecure.azs";
	mimeTypes[".azw"] = "application/vnd.amazon.ebook";
	mimeTypes[".bat"] = "application/x-msdownload";
	mimeTypes[".bcpio"] = "application/x-bcpio";
	mimeTypes[".bdf"] = "application/x-font-bdf";
	mimeTypes[".bdm"] = "application/vnd.syncml.dm+wbxml";
	mimeTypes[".bed"] = "application/vnd.realvnc.bed";
	mimeTypes[".bh2"] = "application/vnd.fujitsu.oasysprs";
	mimeTypes[".bin"] = "application/octet-stream";
	mimeTypes[".blb"] = "application/x-blorb";
	mimeTypes[".blorb"] = "application/x-blorb";
	mimeTypes[".bmi"] = "application/vnd.bmi";
	mimeTypes[".bmp"] = "image/bmp";
	mimeTypes[".book"] = "application/vnd.framemaker";
	mimeTypes[".box"] = "application/vnd.previewsystems.box";
	mimeTypes[".boz"] = "application/x-bzip2";
	mimeTypes[".bpk"] = "application/octet-stream";
	mimeTypes[".btif"] = "image/prs.btif";
	mimeTypes[".bz"] = "application/x-bzip";
	mimeTypes[".bz2"] = "application/x-bzip2";
	mimeTypes[".c"] = "text/x-c";
	mimeTypes[".c11amc"] = "application/vnd.cluetrust.cartomobile-config";
	mimeTypes[".c11amz"] = "application/vnd.cluetrust.cartomobile-config-pkg";
	mimeTypes[".c4d"] = "application/vnd.clonk.c4group";
	mimeTypes[".c4f"] = "application/vnd.clonk.c4group";
	mimeTypes[".c4g"] = "application/vnd.clonk.c4group";
	mimeTypes[".c4p"] = "application/vnd.clonk.c4group";
	mimeTypes[".c4u"] = "application/vnd.clonk.c4group";
	mimeTypes[".cab"] = "application/vnd.ms-cab-compressed";
	mimeTypes[".caf"] = "audio/x-caf";
	mimeTypes[".cap"] = "application/vnd.tcpdump.pcap";
	mimeTypes[".car"] = "application/vnd.curl.car";
	mimeTypes[".cat"] = "application/vnd.ms-pki.seccat";
	mimeTypes[".cb7"] = "application/x-cbr";
	mimeTypes[".cba"] = "application/x-cbr";
	mimeTypes[".cbr"] = "application/x-cbr";
	mimeTypes[".cbt"] = "application/x-cbr";
	mimeTypes[".cbz"] = "application/x-cbr";
	mimeTypes[".cc"] = "text/x-c";
	mimeTypes[".cct"] = "application/x-director";
	mimeTypes[".ccxml"] = "application/ccxml+xml";
	mimeTypes[".cdbcmsg"] = "application/vnd.contact.cmsg";
	mimeTypes[".cdf"] = "application/x-netcdf";
	mimeTypes[".cdkey"] = "application/vnd.mediastation.cdkey";
	mimeTypes[".cdmia"] = "application/cdmi-capability";
	mimeTypes[".cdmic"] = "application/cdmi-container";
	mimeTypes[".cdmid"] = "application/cdmi-domain";
	mimeTypes[".cdmio"] = "application/cdmi-object";
	mimeTypes[".cdmiq"] = "application/cdmi-queue";
	mimeTypes[".cdx"] = "chemical/x-cdx";
	mimeTypes[".cdxml"] = "application/vnd.chemdraw+xml";
	mimeTypes[".cdy"] = "application/vnd.cinderella";
	mimeTypes[".cer"] = "application/pkix-cert";
	mimeTypes[".cfs"] = "application/x-cfs-compressed";
	mimeTypes[".cgm"] = "image/cgm";
	mimeTypes[".chat"] = "application/x-chat";
	mimeTypes[".chm"] = "application/vnd.ms-htmlhelp";
	mimeTypes[".chrt"] = "application/vnd.kde.kchart";
	mimeTypes[".cif"] = "chemical/x-cif";
	mimeTypes[".cii"] = "application/vnd.anser-web-certificate-issue-initiation";
	mimeTypes[".cil"] = "application/vnd.ms-artgalry";
	mimeTypes[".cla"] = "application/vnd.claymore";
	mimeTypes[".class"] = "application/java-vm";
	mimeTypes[".clkk"] = "application/vnd.crick.clicker.keyboard";
	mimeTypes[".clkp"] = "application/vnd.crick.clicker.palette";
	mimeTypes[".clkt"] = "application/vnd.crick.clicker.template";
	mimeTypes[".clkw"] = "application/vnd.crick.clicker.wordbank";
	mimeTypes[".clkx"] = "application/vnd.crick.clicker";
	mimeTypes[".clp"] = "application/x-msclip";
	mimeTypes[".cmc"] = "application/vnd.cosmocaller";
	mimeTypes[".cmdf"] = "chemical/x-cmdf";
	mimeTypes[".cml"] = "chemical/x-cml";
	mimeTypes[".cmp"] = "application/vnd.yellowriver-custom-menu";
	mimeTypes[".cmx"] = "image/x-cmx";
	mimeTypes[".cod"] = "application/vnd.rim.cod";
	mimeTypes[".com"] = "application/x-msdownload";
	mimeTypes[".conf"] = "text/plain";
	mimeTypes[".cpio"] = "application/x-cpio";
	mimeTypes[".cpp"] = "text/x-c";
	mimeTypes[".cpt"] = "application/mac-compactpro";
	mimeTypes[".crd"] = "application/x-mscardfile";
	mimeTypes[".crl"] = "application/pkix-crl";
	mimeTypes[".crt"] = "application/x-x509-ca-cert";
	mimeTypes[".cryptonote"] = "application/vnd.rig.cryptonote";
	mimeTypes[".csh"] = "application/x-csh";
	mimeTypes[".csml"] = "chemical/x-csml";
	mimeTypes[".csp"] = "application/vnd.commonspace";
	mimeTypes[".css"] = "text/css";
	mimeTypes[".cst"] = "application/x-director";
	mimeTypes[".csv"] = "text/csv";
	mimeTypes[".cu"] = "application/cu-seeme";
	mimeTypes[".curl"] = "text/vnd.curl";
	mimeTypes[".cww"] = "application/prs.cww";
	mimeTypes[".cxt"] = "application/x-director";
	mimeTypes[".cxx"] = "text/x-c";
	mimeTypes[".dae"] = "model/vnd.collada+xml";
	mimeTypes[".daf"] = "application/vnd.mobius.daf";
	mimeTypes[".dart"] = "application/vnd.dart";
	mimeTypes[".dataless"] = "application/vnd.fdsn.seed";
	mimeTypes[".davmount"] = "application/davmount+xml";
	mimeTypes[".dbk"] = "application/docbook+xml";
	mimeTypes[".dcr"] = "application/x-director";
	mimeTypes[".dcurl"] = "text/vnd.curl.dcurl";
	mimeTypes[".dd2"] = "application/vnd.oma.dd2+xml";
	mimeTypes[".ddd"] = "application/vnd.fujixerox.ddd";
	mimeTypes[".deb"] = "application/x-debian-package";
	mimeTypes[".def"] = "text/plain";
	mimeTypes[".deploy"] = "application/octet-stream";
	mimeTypes[".der"] = "application/x-x509-ca-cert";
	mimeTypes[".dfac"] = "application/vnd.dreamfactory";
	mimeTypes[".dgc"] = "application/x-dgc-compressed";
	mimeTypes[".dic"] = "text/x-c";
	mimeTypes[".dif"] = "video/x-dv";
	mimeTypes[".dir"] = "application/x-director";
	mimeTypes[".dis"] = "application/vnd.mobius.dis";
	mimeTypes[".dist"] = "application/octet-stream";
	mimeTypes[".distz"] = "application/octet-stream";
	mimeTypes[".djv"] = "image/vnd.djvu";
	mimeTypes[".djvu"] = "image/vnd.djvu";
	mimeTypes[".dll"] = "application/x-msdownload";
	mimeTypes[".dmg"] = "application/x-apple-diskimage";
	mimeTypes[".dmp"] = "application/vnd.tcpdump.pcap";
	mimeTypes[".dms"] = "application/octet-stream";
	mimeTypes[".dna"] = "application/vnd.dna";
	mimeTypes[".doc"] = "application/msword";
	mimeTypes[".docm"] = "application/vnd.ms-word.document.macroenabled.12";
	mimeTypes[".docx"] = "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
	mimeTypes[".dot"] = "application/msword";
	mimeTypes[".dotm"] = "application/vnd.ms-word.template.macroenabled.12";
	mimeTypes[".dotx"] = "application/vnd.openxmlformats-officedocument.wordprocessingml.template";
	mimeTypes[".dp"] = "application/vnd.osgi.dp";
	mimeTypes[".dpg"] = "application/vnd.dpgraph";
	mimeTypes[".dra"] = "audio/vnd.dra";
	mimeTypes[".dsc"] = "text/prs.lines.tag";
	mimeTypes[".dssc"] = "application/dssc+der";
	mimeTypes[".dtb"] = "application/x-dtbook+xml";
	mimeTypes[".dtd"] = "application/xml-dtd";
	mimeTypes[".dts"] = "audio/vnd.dts";
	mimeTypes[".dtshd"] = "audio/vnd.dts.hd";
	mimeTypes[".dump"] = "application/octet-stream";
	mimeTypes[".dv"] = "video/x-dv";
	mimeTypes[".dvb"] = "video/vnd.dvb.file";
	mimeTypes[".dvi"] = "application/x-dvi";
	mimeTypes[".dwf"] = "model/vnd.dwf";
	mimeTypes[".dwg"] = "image/vnd.dwg";
	mimeTypes[".dxf"] = "image/vnd.dxf";
	mimeTypes[".dxp"] = "application/vnd.spotfire.dxp";
	mimeTypes[".dxr"] = "application/x-director";
	mimeTypes[".ecelp4800"] = "audio/vnd.nuera.ecelp4800";
	mimeTypes[".ecelp7470"] = "audio/vnd.nuera.ecelp7470";
	mimeTypes[".ecelp9600"] = "audio/vnd.nuera.ecelp9600";
	mimeTypes[".ecma"] = "application/ecmascript";
	mimeTypes[".edm"] = "application/vnd.novadigm.edm";
	mimeTypes[".edx"] = "application/vnd.novadigm.edx";
	mimeTypes[".efif"] = "application/vnd.picsel";
	mimeTypes[".ei6"] = "application/vnd.pg.osasli";
	mimeTypes[".elc"] = "application/octet-stream";
	mimeTypes[".emf"] = "application/x-msmetafile";
	mimeTypes[".eml"] = "message/rfc822";
	mimeTypes[".emma"] = "application/emma+xml";
	mimeTypes[".emz"] = "application/x-msmetafile";
	mimeTypes[".eol"] = "audio/vnd.digital-winds";
	mimeTypes[".eot"] = "application/vnd.ms-fontobject";
	mimeTypes[".eps"] = "application/postscript";
	mimeTypes[".epub"] = "application/epub+zip";
	mimeTypes[".es3"] = "application/vnd.eszigno3+xml";
	mimeTypes[".esa"] = "application/vnd.osgi.subsystem";
	mimeTypes[".esf"] = "application/vnd.epson.esf";
	mimeTypes[".et3"] = "application/vnd.eszigno3+xml";
	mimeTypes[".etx"] = "text/x-setext";
	mimeTypes[".eva"] = "application/x-eva";
	mimeTypes[".evy"] = "application/x-envoy";
	mimeTypes[".exe"] = "application/x-msdownload";
	mimeTypes[".exi"] = "application/exi";
	mimeTypes[".ext"] = "application/vnd.novadigm.ext";
	mimeTypes[".ez"] = "application/andrew-inset";
	mimeTypes[".ez2"] = "application/vnd.ezpix-album";
	mimeTypes[".ez3"] = "application/vnd.ezpix-package";
	mimeTypes[".f"] = "text/x-fortran";
	mimeTypes[".f4v"] = "video/x-f4v";
	mimeTypes[".f77"] = "text/x-fortran";
	mimeTypes[".f90"] = "text/x-fortran";
	mimeTypes[".fbs"] = "image/vnd.fastbidsheet";
	mimeTypes[".fcdt"] = "application/vnd.adobe.formscentral.fcdt";
	mimeTypes[".fcs"] = "application/vnd.isac.fcs";
	mimeTypes[".fdf"] = "application/vnd.fdf";
	mimeTypes[".fe_launch"] = "application/vnd.denovo.fcselayout-link";
	mimeTypes[".fg5"] = "application/vnd.fujitsu.oasysgp";
	mimeTypes[".fgd"] = "application/x-director";
	mimeTypes[".fh"] = "image/x-freehand";
	mimeTypes[".fh4"] = "image/x-freehand";
	mimeTypes[".fh5"] = "image/x-freehand";
	mimeTypes[".fh7"] = "image/x-freehand";
	mimeTypes[".fhc"] = "image/x-freehand";
	mimeTypes[".fig"] = "application/x-xfig";
	mimeTypes[".flac"] = "audio/x-flac";
	mimeTypes[".fli"] = "video/x-fli";
	mimeTypes[".flo"] = "application/vnd.micrografx.flo";
	mimeTypes[".flv"] = "video/x-flv";
	mimeTypes[".flw"] = "application/vnd.kde.kivio";
	mimeTypes[".flx"] = "text/vnd.fmi.flexstor";
	mimeTypes[".fly"] = "text/vnd.fly";
	mimeTypes[".fm"] = "application/vnd.framemaker";
	mimeTypes[".fnc"] = "application/vnd.frogans.fnc";
	mimeTypes[".for"] = "text/x-fortran";
	mimeTypes[".fpx"] = "image/vnd.fpx";
	mimeTypes[".frame"] = "application/vnd.framemaker";
	mimeTypes[".fsc"] = "application/vnd.fsc.weblaunch";
	mimeTypes[".fst"] = "image/vnd.fst";
	mimeTypes[".ftc"] = "application/vnd.fluxtime.clip";
	mimeTypes[".fti"] = "application/vnd.anser-web-funds-transfer-initiation";
	mimeTypes[".fvt"] = "video/vnd.fvt";
	mimeTypes[".fxp"] = "application/vnd.adobe.fxp";
	mimeTypes[".fxpl"] = "application/vnd.adobe.fxp";
	mimeTypes[".fzs"] = "application/vnd.fuzzysheet";
	mimeTypes[".g2w"] = "application/vnd.geoplan";
	mimeTypes[".g3"] = "image/g3fax";
	mimeTypes[".g3w"] = "application/vnd.geospace";
	mimeTypes[".gac"] = "application/vnd.groove-account";
	mimeTypes[".gam"] = "application/x-tads";
	mimeTypes[".gbr"] = "application/rpki-ghostbusters";
	mimeTypes[".gca"] = "application/x-gca-compressed";
	mimeTypes[".gdl"] = "model/vnd.gdl";
	mimeTypes[".geo"] = "application/vnd.dynageo";
	mimeTypes[".gex"] = "application/vnd.geometry-explorer";
	mimeTypes[".ggb"] = "application/vnd.geogebra.file";
	mimeTypes[".ggt"] = "application/vnd.geogebra.tool";
	mimeTypes[".ghf"] = "application/vnd.groove-help";
	mimeTypes[".gif"] = "image/gif";
	mimeTypes[".gim"] = "application/vnd.groove-identity-message";
	mimeTypes[".gml"] = "application/gml+xml";
	mimeTypes[".gmx"] = "application/vnd.gmx";
	mimeTypes[".gnumeric"] = "application/x-gnumeric";
	mimeTypes[".gph"] = "application/vnd.flographit";
	mimeTypes[".gpx"] = "application/gpx+xml";
	mimeTypes[".gqf"] = "application/vnd.grafeq";
	mimeTypes[".gqs"] = "application/vnd.grafeq";
	mimeTypes[".gram"] = "application/srgs";
	mimeTypes[".gramps"] = "application/x-gramps-xml";
	mimeTypes[".gre"] = "application/vnd.geometry-explorer";
	mimeTypes[".grv"] = "application/vnd.groove-injector";
	mimeTypes[".grxml"] = "application/srgs+xml";
	mimeTypes[".gsf"] = "application/x-font-ghostscript";
	mimeTypes[".gtar"] = "application/x-gtar";
	mimeTypes[".gtm"] = "application/vnd.groove-tool-message";
	mimeTypes[".gtw"] = "model/vnd.gtw";
	mimeTypes[".gv"] = "text/vnd.graphviz";
	mimeTypes[".gxf"] = "application/gxf";
	mimeTypes[".gxt"] = "application/vnd.geonext";
	mimeTypes[".h"] = "text/x-c";
	mimeTypes[".h261"] = "video/h261";
	mimeTypes[".h263"] = "video/h263";
	mimeTypes[".h264"] = "video/h264";
	mimeTypes[".h5"] = "application/x-hdf5";
	mimeTypes[".hal"] = "application/vnd.hal+xml";
	mimeTypes[".hbci"] = "application/vnd.hbci";
	mimeTypes[".hdf"] = "application/x-hdf";
	mimeTypes[".heic"] = "image/heic";
	mimeTypes[".heif"] = "image/heif";
	mimeTypes[".hh"] = "text/x-c";
	mimeTypes[".hlp"] = "application/winhlp";
	mimeTypes[".hpgl"] = "application/vnd.hp-hpgl";
	mimeTypes[".hpid"] = "application/vnd.hp-hpid";
	mimeTypes[".hps"] = "application/vnd.hp-hps";
	mimeTypes[".hqx"] = "application/mac-binhex40";
	mimeTypes[".htke"] = "application/vnd.kenameaapp";
	mimeTypes[".htm"] = "text/html";
	mimeTypes[".html"] = "text/html";
	mimeTypes[".hvd"] = "application/vnd.yamaha.hv-dic";
	mimeTypes[".hvp"] = "application/vnd.yamaha.hv-voice";
	mimeTypes[".hvs"] = "application/vnd.yamaha.hv-script";
	mimeTypes[".i2g"] = "application/vnd.intergeo";
	mimeTypes[".icc"] = "application/vnd.iccprofile";
	mimeTypes[".ice"] = "x-conference/x-cooltalk";
	mimeTypes[".icm"] = "application/vnd.iccprofile";
	mimeTypes[".ico"] = "image/x-icon";
	mimeTypes[".ics"] = "text/calendar";
	mimeTypes[".ief"] = "image/ief";
	mimeTypes[".ifb"] = "text/calendar";
	mimeTypes[".ifm"] = "application/vnd.shana.informed.formdata";
	mimeTypes[".iges"] = "model/iges";
	mimeTypes[".igl"] = "application/vnd.igloader";
	mimeTypes[".igm"] = "application/vnd.insors.igm";
	mimeTypes[".igs"] = "model/iges";
	mimeTypes[".igx"] = "application/vnd.micrografx.igx";
	mimeTypes[".iif"] = "application/vnd.shana.informed.interchange";
	mimeTypes[".imp"] = "application/vnd.accpac.simply.imp";
	mimeTypes[".ims"] = "application/vnd.ms-ims";
	mimeTypes[".in"] = "text/plain";
	mimeTypes[".ink"] = "application/inkml+xml";
	mimeTypes[".inkml"] = "application/inkml+xml";
	mimeTypes[".install"] = "application/x-install-instructions";
	mimeTypes[".iota"] = "application/vnd.astraea-software.iota";
	mimeTypes[".ipfix"] = "application/ipfix";
	mimeTypes[".ipk"] = "application/vnd.shana.informed.package";
	mimeTypes[".irm"] = "application/vnd.ibm.rights-management";
	mimeTypes[".irp"] = "application/vnd.irepository.package+xml";
	mimeTypes[".iso"] = "application/x-iso9660-image";
	mimeTypes[".itp"] = "application/vnd.shana.informed.formtemplate";
	mimeTypes[".ivp"] = "application/vnd.immervision-ivp";
	mimeTypes[".ivu"] = "application/vnd.immervision-ivu";
	mimeTypes[".jad"] = "text/vnd.sun.j2me.app-descriptor";
	mimeTypes[".jam"] = "application/vnd.jam";
	mimeTypes[".jar"] = "application/java-archive";
	mimeTypes[".java"] = "text/x-java-source";
	mimeTypes[".jisp"] = "application/vnd.jisp";
	mimeTypes[".jlt"] = "application/vnd.hp-jlyt";
	mimeTypes[".jnlp"] = "application/x-java-jnlp-file";
	mimeTypes[".joda"] = "application/vnd.joost.joda-archive";
	mimeTypes[".jp2"] = "image/jp2";
	mimeTypes[".jpe"] = "image/jpeg";
	mimeTypes[".jpeg"] = "image/jpeg";
	mimeTypes[".jpg"] = "image/jpeg";
	mimeTypes[".jpgm"] = "video/jpm";
	mimeTypes[".jpgv"] = "video/jpeg";
	mimeTypes[".jpm"] = "video/jpm";
	mimeTypes[".js"] = "application/javascript";
	mimeTypes[".json"] = "application/json";
	mimeTypes[".jsonml"] = "application/jsonml+json";
	mimeTypes[".kar"] = "audio/midi";
	mimeTypes[".karbon"] = "application/vnd.kde.karbon";
	mimeTypes[".kfo"] = "application/vnd.kde.kformula";
	mimeTypes[".kia"] = "application/vnd.kidspiration";
	mimeTypes[".kml"] = "application/vnd.google-earth.kml+xml";
	mimeTypes[".kmz"] = "application/vnd.google-earth.kmz";
	mimeTypes[".kne"] = "application/vnd.kinar";
	mimeTypes[".knp"] = "application/vnd.kinar";
	mimeTypes[".kon"] = "application/vnd.kde.kontour";
	mimeTypes[".kpr"] = "application/vnd.kde.kpresenter";
	mimeTypes[".kpt"] = "application/vnd.kde.kpresenter";
	mimeTypes[".kpxx"] = "application/vnd.ds-keypoint";
	mimeTypes[".ksh"] = "text/plain";
	mimeTypes[".ksp"] = "application/vnd.kde.kspread";
	mimeTypes[".ktr"] = "application/vnd.kahootz";
	mimeTypes[".ktx"] = "image/ktx";
	mimeTypes[".ktz"] = "application/vnd.kahootz";
	mimeTypes[".kwd"] = "application/vnd.kde.kword";
	mimeTypes[".kwt"] = "application/vnd.kde.kword";
	mimeTypes[".lasxml"] = "application/vnd.las.las+xml";
	mimeTypes[".latex"] = "application/x-latex";
	mimeTypes[".lbd"] = "application/vnd.llamagraphics.life-balance.desktop";
	mimeTypes[".lbe"] = "application/vnd.llamagraphics.life-balance.exchange+xml";
	mimeTypes[".les"] = "application/vnd.hhe.lesson-player";
	mimeTypes[".lha"] = "application/x-lzh-compressed";
	mimeTypes[".link66"] = "application/vnd.route66.link66+xml";
	mimeTypes[".list"] = "text/plain";
	mimeTypes[".list3820"] = "application/vnd.ibm.modcap";
	mimeTypes[".listafp"] = "application/vnd.ibm.modcap";
	mimeTypes[".lnk"] = "application/x-ms-shortcut";
	mimeTypes[".loas"] = "audio/aac";
	mimeTypes[".log"] = "text/plain";
	mimeTypes[".lostxml"] = "application/lost+xml";
	mimeTypes[".lrf"] = "application/octet-stream";
	mimeTypes[".lrm"] = "application/vnd.ms-lrm";
	mimeTypes[".ltf"] = "application/vnd.frogans.ltf";
	mimeTypes[".lvp"] = "audio/vnd.lucent.voice";
	mimeTypes[".lwp"] = "application/vnd.lotus-wordpro";
	mimeTypes[".lzh"] = "application/x-lzh-compressed";
	mimeTypes[".m13"] = "application/x-msmediaview";
	mimeTypes[".m14"] = "application/x-msmediaview";
	mimeTypes[".m1v"] = "video/mpeg";
	mimeTypes[".m21"] = "application/mp21";
	mimeTypes[".m2a"] = "audio/mpeg";
	mimeTypes[".m2v"] = "video/mpeg";
	mimeTypes[".m3a"] = "audio/mpeg";
	mimeTypes[".m3u"] = "audio/x-mpegurl";
	mimeTypes[".m3u8"] = "application/x-mpegurl";
	mimeTypes[".m4a"] = "audio/mp4a-latm";
	mimeTypes[".m4p"] = "audio/mp4a-latm";
	mimeTypes[".m4u"] = "video/vnd.mpegurl";
	mimeTypes[".m4v"] = "video/x-m4v";
	mimeTypes[".ma"] = "application/mathematica";
	mimeTypes[".mac"] = "image/x-macpaint";
	mimeTypes[".mads"] = "application/mads+xml";
	mimeTypes[".mag"] = "application/vnd.ecowin.chart";
	mimeTypes[".maker"] = "application/vnd.framemaker";
	mimeTypes[".man"] = "text/troff";
	mimeTypes[".manifest"] = "text/cache-manifest";
	mimeTypes[".mar"] = "application/octet-stream";
	mimeTypes[".mathml"] = "application/mathml+xml";
	mimeTypes[".mb"] = "application/mathematica";
	mimeTypes[".mbk"] = "application/vnd.mobius.mbk";
	mimeTypes[".mbox"] = "application/mbox";
	mimeTypes[".mc1"] = "application/vnd.medcalcdata";
	mimeTypes[".mcd"] = "application/vnd.mcd";
	mimeTypes[".mcurl"] = "text/vnd.curl.mcurl";
	mimeTypes[".mdb"] = "application/x-msaccess";
	mimeTypes[".mdi"] = "image/vnd.ms-modi";
	mimeTypes[".me"] = "text/troff";
	mimeTypes[".mesh"] = "model/mesh";
	mimeTypes[".meta4"] = "application/metalink4+xml";
	mimeTypes[".metalink"] = "application/metalink+xml";
	mimeTypes[".mets"] = "application/mets+xml";
	mimeTypes[".mfm"] = "application/vnd.mfmp";
	mimeTypes[".mft"] = "application/rpki-manifest";
	mimeTypes[".mgp"] = "application/vnd.osgeo.mapguide.package";
	mimeTypes[".mgz"] = "application/vnd.proteus.magazine";
	mimeTypes[".mht"] = "message/rfc822";
	mimeTypes[".mhtml"] = "message/rfc822";
	mimeTypes[".mid"] = "audio/midi";
	mimeTypes[".midi"] = "audio/midi";
	mimeTypes[".mie"] = "application/x-mie";
	mimeTypes[".mif"] = "application/vnd.mif";
	mimeTypes[".mime"] = "message/rfc822";
	mimeTypes[".mj2"] = "video/mj2";
	mimeTypes[".mjp2"] = "video/mj2";
	mimeTypes[".mjs"] = "application/javascript";
	mimeTypes[".mk3d"] = "video/x-matroska";
	mimeTypes[".mka"] = "audio/x-matroska";
	mimeTypes[".mks"] = "video/x-matroska";
	mimeTypes[".mkv"] = "video/x-matroska";
	mimeTypes[".mlp"] = "application/vnd.dolby.mlp";
	mimeTypes[".mmd"] = "application/vnd.chipnuts.karaoke-mmd";
	mimeTypes[".mmf"] = "application/vnd.smaf";
	mimeTypes[".mmr"] = "image/vnd.fujixerox.edmics-mmr";
	mimeTypes[".mng"] = "video/x-mng";
	mimeTypes[".mny"] = "application/x-msmoney";
	mimeTypes[".mobi"] = "application/x-mobipocket-ebook";
	mimeTypes[".mobipocket-ebook"] = "application/octet-stream";
	mimeTypes[".mods"] = "application/mods+xml";
	mimeTypes[".mov"] = "video/quicktime";
	mimeTypes[".movie"] = "video/x-sgi-movie";
	mimeTypes[".mp2"] = "audio/mpeg";
	mimeTypes[".mp21"] = "application/mp21";
	mimeTypes[".mp2a"] = "audio/mpeg";
	mimeTypes[".mp3"] = "audio/mpeg";
	mimeTypes[".mp4"] = "video/mp4";
	mimeTypes[".mp4a"] = "audio/mp4";
	mimeTypes[".mp4s"] = "application/mp4";
	mimeTypes[".mp4v"] = "video/mp4";
	mimeTypes[".mpa"] = "video/mpeg";
	mimeTypes[".mpc"] = "application/vnd.mophun.certificate";
	mimeTypes[".mpe"] = "video/mpeg";
	mimeTypes[".mpeg"] = "video/mpeg";
	mimeTypes[".mpg"] = "video/mpeg";
	mimeTypes[".mpg4"] = "video/mp4";
	mimeTypes[".mpga"] = "audio/mpeg";
	mimeTypes[".mpkg"] = "application/vnd.apple.installer+xml";
	mimeTypes[".mpm"] = "application/vnd.blueice.multipass";
	mimeTypes[".mpn"] = "application/vnd.mophun.application";
	mimeTypes[".mpp"] = "application/vnd.ms-project";
	mimeTypes[".mpt"] = "application/vnd.ms-project";
	mimeTypes[".mpy"] = "application/vnd.ibm.minipay";
	mimeTypes[".mqy"] = "application/vnd.mobius.mqy";
	mimeTypes[".mrc"] = "application/marc";
	mimeTypes[".mrcx"] = "application/marcxml+xml";
	mimeTypes[".ms"] = "text/troff";
	mimeTypes[".mscml"] = "application/mediaservercontrol+xml";
	mimeTypes[".mseed"] = "application/vnd.fdsn.mseed";
	mimeTypes[".mseq"] = "application/vnd.mseq";
	mimeTypes[".msf"] = "application/vnd.epson.msf";
	mimeTypes[".msh"] = "model/mesh";
	mimeTypes[".msi"] = "application/x-msdownload";
	mimeTypes[".msl"] = "application/vnd.mobius.msl";
	mimeTypes[".msty"] = "application/vnd.muvee.style";
	mimeTypes[".mts"] = "model/vnd.mts";
	mimeTypes[".mus"] = "application/vnd.musician";
	mimeTypes[".musicxml"] = "application/vnd.recordare.musicxml+xml";
	mimeTypes[".mvb"] = "application/x-msmediaview";
	mimeTypes[".mwf"] = "application/vnd.mfer";
	mimeTypes[".mxf"] = "application/mxf";
	mimeTypes[".mxl"] = "application/vnd.recordare.musicxml";
	mimeTypes[".mxml"] = "application/xv+xml";
	mimeTypes[".mxs"] = "application/vnd.triscape.mxs";
	mimeTypes[".mxu"] = "video/vnd.mpegurl";
	mimeTypes[".n-gage"] = "application/vnd.nokia.n-gage.symbian.install";
	mimeTypes[".n3"] = "text/n3";
	mimeTypes[".nb"] = "application/mathematica";
	mimeTypes[".nbp"] = "application/vnd.wolfram.player";
	mimeTypes[".nc"] = "application/x-netcdf";
	mimeTypes[".ncx"] = "application/x-dtbncx+xml";
	mimeTypes[".nfo"] = "text/x-nfo";
	mimeTypes[".ngdat"] = "application/vnd.nokia.n-gage.data";
	mimeTypes[".nitf"] = "application/vnd.nitf";
	mimeTypes[".nlu"] = "application/vnd.neurolanguage.nlu";
	mimeTypes[".nml"] = "application/vnd.enliven";
	mimeTypes[".nnd"] = "application/vnd.noblenet-directory";
	mimeTypes[".nns"] = "application/vnd.noblenet-sealer";
	mimeTypes[".nnw"] = "application/vnd.noblenet-web";
	mimeTypes[".npx"] = "image/vnd.net-fpx";
	mimeTypes[".nq"] = "application/n-quads";
	mimeTypes[".nsc"] = "application/x-conference";
	mimeTypes[".nsf"] = "application/vnd.lotus-notes";
	mimeTypes[".nt"] = "application/n-triples";
	mimeTypes[".ntf"] = "application/vnd.nitf";
	mimeTypes[".nws"] = "message/rfc822";
	mimeTypes[".nzb"] = "application/x-nzb";
	mimeTypes[".o"] = "application/octet-stream";
	mimeTypes[".oa2"] = "application/vnd.fujitsu.oasys2";
	mimeTypes[".oa3"] = "application/vnd.fujitsu.oasys3";
	mimeTypes[".oas"] = "application/vnd.fujitsu.oasys";
	mimeTypes[".obd"] = "application/x-msbinder";
	mimeTypes[".obj"] = "application/x-tgif";
	mimeTypes[".oda"] = "application/oda";
	mimeTypes[".odb"] = "application/vnd.oasis.opendocument.database";
	mimeTypes[".odc"] = "application/vnd.oasis.opendocument.chart";
	mimeTypes[".odf"] = "application/vnd.oasis.opendocument.formula";
	mimeTypes[".odft"] = "application/vnd.oasis.opendocument.formula-template";
	mimeTypes[".odg"] = "application/vnd.oasis.opendocument.graphics";
	mimeTypes[".odi"] = "application/vnd.oasis.opendocument.image";
	mimeTypes[".odm"] = "application/vnd.oasis.opendocument.text-master";
	mimeTypes[".odp"] = "application/vnd.oasis.opendocument.presentation";
	mimeTypes[".ods"] = "application/vnd.oasis.opendocument.spreadsheet";
	mimeTypes[".odt"] = "application/vnd.oasis.opendocument.text";
	mimeTypes[".oga"] = "audio/ogg";
	mimeTypes[".ogg"] = "audio/ogg";
	mimeTypes[".ogv"] = "video/ogg";
	mimeTypes[".ogx"] = "application/ogg";
	mimeTypes[".omdoc"] = "application/omdoc+xml";
	mimeTypes[".onepkg"] = "application/onenote";
	mimeTypes[".onetmp"] = "application/onenote";
	mimeTypes[".onetoc"] = "application/onenote";
	mimeTypes[".onetoc2"] = "application/onenote";
	mimeTypes[".opf"] = "application/oebps-package+xml";
	mimeTypes[".opml"] = "text/x-opml";
	mimeTypes[".oprc"] = "application/vnd.palm";
	mimeTypes[".opus"] = "audio/opus";
	mimeTypes[".org"] = "application/vnd.lotus-organizer";
	mimeTypes[".osf"] = "application/vnd.yamaha.openscoreformat";
	mimeTypes[".osfpvg"] = "application/vnd.yamaha.openscoreformat.osfpvg+xml";
	mimeTypes[".otc"] = "application/vnd.oasis.opendocument.chart-template";
	mimeTypes[".otf"] = "font/otf";
	mimeTypes[".otg"] = "application/vnd.oasis.opendocument.graphics-template";
	mimeTypes[".oth"] = "application/vnd.oasis.opendocument.text-web";
	mimeTypes[".oti"] = "application/vnd.oasis.opendocument.image-template";
	mimeTypes[".otp"] = "application/vnd.oasis.opendocument.presentation-template";
	mimeTypes[".ots"] = "application/vnd.oasis.opendocument.spreadsheet-template";
	mimeTypes[".ott"] = "application/vnd.oasis.opendocument.text-template";
	mimeTypes[".oxps"] = "application/oxps";
	mimeTypes[".oxt"] = "application/vnd.openofficeorg.extension";
	mimeTypes[".p"] = "text/x-pascal";
	mimeTypes[".p10"] = "application/pkcs10";
	mimeTypes[".p12"] = "application/x-pkcs12";
	mimeTypes[".p7b"] = "application/x-pkcs7-certificates";
	mimeTypes[".p7c"] = "application/pkcs7-mime";
	mimeTypes[".p7m"] = "application/pkcs7-mime";
	mimeTypes[".p7r"] = "application/x-pkcs7-certreqresp";
	mimeTypes[".p7s"] = "application/pkcs7-signature";
	mimeTypes[".p8"] = "application/pkcs8";
	mimeTypes[".pas"] = "text/x-pascal";
	mimeTypes[".paw"] = "application/vnd.pawaafile";
	mimeTypes[".pbd"] = "application/vnd.powerbuilder6";
	mimeTypes[".pbm"] = "image/x-portable-bitmap";
	mimeTypes[".pcap"] = "application/vnd.tcpdump.pcap";
	mimeTypes[".pcf"] = "application/x-font-pcf";
	mimeTypes[".pcl"] = "application/vnd.hp-pcl";
	mimeTypes[".pclxl"] = "application/vnd.hp-pclxl";
	mimeTypes[".pct"] = "image/x-pict";
	mimeTypes[".pcurl"] = "application/vnd.curl.pcurl";
	mimeTypes[".pcx"] = "image/x-pcx";
	mimeTypes[".pdb"] = "application/vnd.palm";
	mimeTypes[".pdf"] = "application/pdf";
	mimeTypes[".pfa"] = "application/x-font-type1";
	mimeTypes[".pfb"] = "application/x-font-type1";
	mimeTypes[".pfm"] = "application/x-font-type1";
	mimeTypes[".pfr"] = "application/font-tdpfr";
	mimeTypes[".pfx"] = "application/x-pkcs12";
	mimeTypes[".pgm"] = "image/x-portable-graymap";
	mimeTypes[".pgn"] = "application/x-chess-pgn";
	mimeTypes[".pgp"] = "application/pgp-encrypted";
	mimeTypes[".pic"] = "image/x-pict";
	mimeTypes[".pict"] = "image/pict";
	mimeTypes[".pkg"] = "application/octet-stream";
	mimeTypes[".pki"] = "application/pkixcmp";
	mimeTypes[".pkipath"] = "application/pkix-pkipath";
	mimeTypes[".pl"] = "text/plain";
	mimeTypes[".plb"] = "application/vnd.3gpp.pic-bw-large";
	mimeTypes[".plc"] = "application/vnd.mobius.plc";
	mimeTypes[".plf"] = "application/vnd.pocketlearn";
	mimeTypes[".pls"] = "application/pls+xml";
	mimeTypes[".pml"] = "application/vnd.ctc-posml";
	mimeTypes[".png"] = "image/png";
	mimeTypes[".pnm"] = "image/x-portable-anymap";
	mimeTypes[".pnt"] = "image/x-macpaint";
	mimeTypes[".pntg"] = "image/x-macpaint";
	mimeTypes[".portpkg"] = "application/vnd.macports.portpkg";
	mimeTypes[".pot"] = "application/vnd.ms-powerpoint";
	mimeTypes[".potm"] = "application/vnd.ms-powerpoint.template.macroenabled.12";
	mimeTypes[".potx"] = "application/vnd.openxmlformats-officedocument.presentationml.template";
	mimeTypes[".ppa"] = "application/vnd.ms-powerpoint";
	mimeTypes[".ppam"] = "application/vnd.ms-powerpoint.addin.macroenabled.12";
	mimeTypes[".ppd"] = "application/vnd.cups-ppd";
	mimeTypes[".ppm"] = "image/x-portable-pixmap";
	mimeTypes[".pps"] = "application/vnd.ms-powerpoint";
	mimeTypes[".ppsm"] = "application/vnd.ms-powerpoint.slideshow.macroenabled.12";
	mimeTypes[".ppsx"] = "application/vnd.openxmlformats-officedocument.presentationml.slideshow";
	mimeTypes[".ppt"] = "application/vnd.ms-powerpoint";
	mimeTypes[".pptm"] = "application/vnd.ms-powerpoint.presentation.macroenabled.12";
	mimeTypes[".pptx"] = "application/vnd.openxmlformats-officedocument.presentationml.presentation";
	mimeTypes[".pqa"] = "application/vnd.palm";
	mimeTypes[".prc"] = "application/x-mobipocket-ebook";
	mimeTypes[".pre"] = "application/vnd.lotus-freelance";
	mimeTypes[".prf"] = "application/pics-rules";
	mimeTypes[".ps"] = "application/postscript";
	mimeTypes[".psb"] = "application/vnd.3gpp.pic-bw-small";
	mimeTypes[".psd"] = "image/vnd.adobe.photoshop";
	mimeTypes[".psf"] = "application/x-font-linux-psf";
	mimeTypes[".pskcxml"] = "application/pskc+xml";
	mimeTypes[".ptid"] = "application/vnd.pvi.ptid1";
	mimeTypes[".pub"] = "application/x-mspublisher";
	mimeTypes[".pvb"] = "application/vnd.3gpp.pic-bw-var";
	mimeTypes[".pwn"] = "application/vnd.3m.post-it-notes";
	mimeTypes[".pwz"] = "application/vnd.ms-powerpoint";
	mimeTypes[".py"] = "text/x-python";
	mimeTypes[".pya"] = "audio/vnd.ms-playready.media.pya";
	mimeTypes[".pyc"] = "application/x-python-code";
	mimeTypes[".pyo"] = "application/x-python-code";
	mimeTypes[".pyv"] = "video/vnd.ms-playready.media.pyv";
	mimeTypes[".qam"] = "application/vnd.epson.quickanime";
	mimeTypes[".qbo"] = "application/vnd.intu.qbo";
	mimeTypes[".qfx"] = "application/vnd.intu.qfx";
	mimeTypes[".qps"] = "application/vnd.publishare-delta-tree";
	mimeTypes[".qt"] = "video/quicktime";
	mimeTypes[".qti"] = "image/x-quicktime";
	mimeTypes[".qtif"] = "image/x-quicktime";
	mimeTypes[".qwd"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".qwt"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".qxb"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".qxd"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".qxl"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".qxt"] = "application/vnd.quark.quarkxpress";
	mimeTypes[".ra"] = "audio/x-pn-realaudio";
	mimeTypes[".ram"] = "audio/x-pn-realaudio";
	mimeTypes[".rar"] = "application/x-rar-compressed";
	mimeTypes[".ras"] = "image/x-cmu-raster";
	mimeTypes[".rcprofile"] = "application/vnd.ipunplugged.rcprofile";
	mimeTypes[".rdf"] = "application/rdf+xml";
	mimeTypes[".rdz"] = "application/vnd.data-vision.rdz";
	mimeTypes[".rep"] = "application/vnd.businessobjects";
	mimeTypes[".res"] = "application/x-dtbresource+xml";
	mimeTypes[".rgb"] = "image/x-rgb";
	mimeTypes[".rif"] = "application/reginfo+xml";
	mimeTypes[".rip"] = "audio/vnd.rip";
	mimeTypes[".ris"] = "application/x-research-info-systems";
	mimeTypes[".rl"] = "application/resource-lists+xml";
	mimeTypes[".rlc"] = "image/vnd.fujixerox.edmics-rlc";
	mimeTypes[".rld"] = "application/resource-lists-diff+xml";
	mimeTypes[".rm"] = "application/vnd.rn-realmedia";
	mimeTypes[".rmi"] = "audio/midi";
	mimeTypes[".rmp"] = "audio/x-pn-realaudio-plugin";
	mimeTypes[".rms"] = "application/vnd.jcp.javame.midlet-rms";
	mimeTypes[".rmvb"] = "application/vnd.rn-realmedia-vbr";
	mimeTypes[".rnc"] = "application/relax-ng-compact-syntax";
	mimeTypes[".roa"] = "application/rpki-roa";
	mimeTypes[".roff"] = "text/troff";
	mimeTypes[".rp9"] = "application/vnd.cloanto.rp9";
	mimeTypes[".rpss"] = "application/vnd.nokia.radio-presets";
	mimeTypes[".rpst"] = "application/vnd.nokia.radio-preset";
	mimeTypes[".rq"] = "application/sparql-query";
	mimeTypes[".rs"] = "application/rls-services+xml";
	mimeTypes[".rsd"] = "application/rsd+xml";
	mimeTypes[".rss"] = "application/rss+xml";
	mimeTypes[".rtf"] = "application/rtf";
	mimeTypes[".rtx"] = "text/richtext";
	mimeTypes[".s"] = "text/x-asm";
	mimeTypes[".s3m"] = "audio/s3m";
	mimeTypes[".saf"] = "application/vnd.yamaha.smaf-audio";
	mimeTypes[".sbml"] = "application/sbml+xml";
	mimeTypes[".sc"] = "application/vnd.ibm.secure-container";
	mimeTypes[".scd"] = "application/x-msschedule";
	mimeTypes[".scm"] = "application/vnd.lotus-screencam";
	mimeTypes[".scq"] = "application/scvp-cv-request";
	mimeTypes[".scs"] = "application/scvp-cv-response";
	mimeTypes[".scurl"] = "text/vnd.curl.scurl";
	mimeTypes[".sda"] = "application/vnd.stardivision.draw";
	mimeTypes[".sdc"] = "application/vnd.stardivision.calc";
	mimeTypes[".sdd"] = "application/vnd.stardivision.impress";
	mimeTypes[".sdkd"] = "application/vnd.solent.sdkm+xml";
	mimeTypes[".sdkm"] = "application/vnd.solent.sdkm+xml";
	mimeTypes[".sdp"] = "application/sdp";
	mimeTypes[".sdw"] = "application/vnd.stardivision.writer";
	mimeTypes[".see"] = "application/vnd.seemail";
	mimeTypes[".seed"] = "application/vnd.fdsn.seed";
	mimeTypes[".sema"] = "application/vnd.sema";
	mimeTypes[".semd"] = "application/vnd.semd";
	mimeTypes[".semf"] = "application/vnd.semf";
	mimeTypes[".ser"] = "application/java-serialized-object";
	mimeTypes[".setpay"] = "application/set-payment-initiation";
	mimeTypes[".setreg"] = "application/set-registration-initiation";
	mimeTypes[".sfd-hdstx"] = "application/vnd.hydrostatix.sof-data";
	mimeTypes[".sfs"] = "application/vnd.spotfire.sfs";
	mimeTypes[".sfv"] = "text/x-sfv";
	mimeTypes[".sgi"] = "image/sgi";
	mimeTypes[".sgl"] = "application/vnd.stardivision.writer-global";
	mimeTypes[".sgm"] = "text/sgml";
	mimeTypes[".sgml"] = "text/sgml";
	mimeTypes[".sh"] = "application/x-sh";
	mimeTypes[".shar"] = "application/x-shar";
	mimeTypes[".shf"] = "application/shf+xml";
	mimeTypes[".sid"] = "image/x-mrsid-image";
	mimeTypes[".sig"] = "application/pgp-signature";
	mimeTypes[".sil"] = "audio/silk";
	mimeTypes[".silo"] = "model/mesh";
	mimeTypes[".sis"] = "application/vnd.symbian.install";
	mimeTypes[".sisx"] = "application/vnd.symbian.install";
	mimeTypes[".sit"] = "application/x-stuffit";
	mimeTypes[".sitx"] = "application/x-stuffitx";
	mimeTypes[".skd"] = "application/vnd.koan";
	mimeTypes[".skm"] = "application/vnd.koan";
	mimeTypes[".skp"] = "application/vnd.koan";
	mimeTypes[".skt"] = "application/vnd.koan";
	mimeTypes[".sldm"] = "application/vnd.ms-powerpoint.slide.macroenabled.12";
	mimeTypes[".sldx"] = "application/vnd.openxmlformats-officedocument.presentationml.slide";
	mimeTypes[".slt"] = "application/vnd.epson.salt";
	mimeTypes[".sm"] = "application/vnd.stepmania.stepchart";
	mimeTypes[".smf"] = "application/vnd.stardivision.math";
	mimeTypes[".smi"] = "application/smil+xml";
	mimeTypes[".smil"] = "application/smil+xml";
	mimeTypes[".smv"] = "video/x-smv";
	mimeTypes[".smzip"] = "application/vnd.stepmania.package";
	mimeTypes[".snd"] = "audio/basic";
	mimeTypes[".snf"] = "application/x-font-snf";
	mimeTypes[".so"] = "application/octet-stream";
	mimeTypes[".spc"] = "application/x-pkcs7-certificates";
	mimeTypes[".spf"] = "application/vnd.yamaha.smaf-phrase";
	mimeTypes[".spl"] = "application/x-futuresplash";
	mimeTypes[".spot"] = "text/vnd.in3d.spot";
	mimeTypes[".spp"] = "application/scvp-vp-response";
	mimeTypes[".spq"] = "application/scvp-vp-request";
	mimeTypes[".spx"] = "audio/ogg";
	mimeTypes[".sql"] = "application/x-sql";
	mimeTypes[".src"] = "application/x-wais-source";
	mimeTypes[".srt"] = "application/x-subrip";
	mimeTypes[".sru"] = "application/sru+xml";
	mimeTypes[".srx"] = "application/sparql-results+xml";
	mimeTypes[".ssdl"] = "application/ssdl+xml";
	mimeTypes[".sse"] = "application/vnd.kodak-descriptor";
	mimeTypes[".ssf"] = "application/vnd.epson.ssf";
	mimeTypes[".ssml"] = "application/ssml+xml";
	mimeTypes[".st"] = "application/vnd.sailingtracker.track";
	mimeTypes[".stc"] = "application/vnd.sun.xml.calc.template";
	mimeTypes[".std"] = "application/vnd.sun.xml.draw.template";
	mimeTypes[".stf"] = "application/vnd.wt.stf";
	mimeTypes[".sti"] = "application/vnd.sun.xml.impress.template";
	mimeTypes[".stk"] = "application/hyperstudio";
	mimeTypes[".stl"] = "application/vnd.ms-pki.stl";
	mimeTypes[".str"] = "application/vnd.pg.format";
	mimeTypes[".stw"] = "application/vnd.sun.xml.writer.template";
	mimeTypes[".sub"] = "text/vnd.dvb.subtitle";
	mimeTypes[".sus"] = "application/vnd.sus-calendar";
	mimeTypes[".susp"] = "application/vnd.sus-calendar";
	mimeTypes[".sv4cpio"] = "application/x-sv4cpio";
	mimeTypes[".sv4crc"] = "application/x-sv4crc";
	mimeTypes[".svc"] = "application/vnd.dvb.service";
	mimeTypes[".svd"] = "application/vnd.svd";
	mimeTypes[".svg"] = "image/svg+xml";
	mimeTypes[".svgz"] = "image/svg+xml";
	mimeTypes[".swa"] = "application/x-director";
	mimeTypes[".swf"] = "application/x-shockwave-flash";
	mimeTypes[".swi"] = "application/vnd.aristanetworks.swi";
	mimeTypes[".sxc"] = "application/vnd.sun.xml.calc";
	mimeTypes[".sxd"] = "application/vnd.sun.xml.draw";
	mimeTypes[".sxg"] = "application/vnd.sun.xml.writer.global";
	mimeTypes[".sxi"] = "application/vnd.sun.xml.impress";
	mimeTypes[".sxm"] = "application/vnd.sun.xml.math";
	mimeTypes[".sxw"] = "application/vnd.sun.xml.writer";
	mimeTypes[".t"] = "text/troff";
	mimeTypes[".t3"] = "application/x-t3vm-image";
	mimeTypes[".taglet"] = "application/vnd.mynfc";
	mimeTypes[".tao"] = "application/vnd.tao.intent-module-archive";
	mimeTypes[".tar"] = "application/x-tar";
	mimeTypes[".tcap"] = "application/vnd.3gpp2.tcap";
	mimeTypes[".tcl"] = "application/x-tcl";
	mimeTypes[".teacher"] = "application/vnd.smart.teacher";
	mimeTypes[".tei"] = "application/tei+xml";
	mimeTypes[".teicorpus"] = "application/tei+xml";
	mimeTypes[".tex"] = "application/x-tex";
	mimeTypes[".texi"] = "application/x-texinfo";
	mimeTypes[".texinfo"] = "application/x-texinfo";
	mimeTypes[".text"] = "text/plain";
	mimeTypes[".tfi"] = "application/thraud+xml";
	mimeTypes[".tfm"] = "application/x-tex-tfm";
	mimeTypes[".tga"] = "image/x-tga";
	mimeTypes[".thmx"] = "application/vnd.ms-officetheme";
	mimeTypes[".tif"] = "image/tiff";
	mimeTypes[".tiff"] = "image/tiff";
	mimeTypes[".tmo"] = "application/vnd.tmobile-livetv";
	mimeTypes[".torrent"] = "application/x-bittorrent";
	mimeTypes[".tpl"] = "application/vnd.groove-tool-template";
	mimeTypes[".tpt"] = "application/vnd.trid.tpt";
	mimeTypes[".tr"] = "text/troff";
	mimeTypes[".tra"] = "application/vnd.trueapp";
	mimeTypes[".trig"] = "application/trig";
	mimeTypes[".trm"] = "application/x-msterminal";
	mimeTypes[".ts"] = "video/mp2t";
	mimeTypes[".tsd"] = "application/timestamped-data";
	mimeTypes[".tsv"] = "text/tab-separated-values";
	mimeTypes[".ttc"] = "font/collection";
	mimeTypes[".ttf"] = "font/ttf";
	mimeTypes[".ttl"] = "text/turtle";
	mimeTypes[".twd"] = "application/vnd.simtech-mindmapper";
	mimeTypes[".twds"] = "application/vnd.simtech-mindmapper";
	mimeTypes[".txd"] = "application/vnd.genomatix.tuxedo";
	mimeTypes[".txf"] = "application/vnd.mobius.txf";
	mimeTypes[".txt"] = "text/plain";
	mimeTypes[".u32"] = "application/x-authorware-bin";
	mimeTypes[".udeb"] = "application/x-debian-package";
	mimeTypes[".ufd"] = "application/vnd.ufdl";
	mimeTypes[".ufdl"] = "application/vnd.ufdl";
	mimeTypes[".ulx"] = "application/x-glulx";
	mimeTypes[".umj"] = "application/vnd.umajin";
	mimeTypes[".unityweb"] = "application/vnd.unity";
	mimeTypes[".uoml"] = "application/vnd.uoml+xml";
	mimeTypes[".uri"] = "text/uri-list";
	mimeTypes[".uris"] = "text/uri-list";
	mimeTypes[".urls"] = "text/uri-list";
	mimeTypes[".ustar"] = "application/x-ustar";
	mimeTypes[".utz"] = "application/vnd.uiq.theme";
	mimeTypes[".uu"] = "text/x-uuencode";
	mimeTypes[".uva"] = "audio/vnd.dece.audio";
	mimeTypes[".uvd"] = "application/vnd.dece.data";
	mimeTypes[".uvf"] = "application/vnd.dece.data";
	mimeTypes[".uvg"] = "image/vnd.dece.graphic";
	mimeTypes[".uvh"] = "video/vnd.dece.hd";
	mimeTypes[".uvi"] = "image/vnd.dece.graphic";
	mimeTypes[".uvm"] = "video/vnd.dece.mobile";
	mimeTypes[".uvp"] = "video/vnd.dece.pd";
	mimeTypes[".uvs"] = "video/vnd.dece.sd";
	mimeTypes[".uvt"] = "application/vnd.dece.ttml+xml";
	mimeTypes[".uvu"] = "video/vnd.uvvu.mp4";
	mimeTypes[".uvv"] = "video/vnd.dece.video";
	mimeTypes[".uvva"] = "audio/vnd.dece.audio";
	mimeTypes[".uvvd"] = "application/vnd.dece.data";
	mimeTypes[".uvvf"] = "application/vnd.dece.data";
	mimeTypes[".uvvg"] = "image/vnd.dece.graphic";
	mimeTypes[".uvvh"] = "video/vnd.dece.hd";
	mimeTypes[".uvvi"] = "image/vnd.dece.graphic";
	mimeTypes[".uvvm"] = "video/vnd.dece.mobile";
	mimeTypes[".uvvp"] = "video/vnd.dece.pd";
	mimeTypes[".uvvs"] = "video/vnd.dece.sd";
	mimeTypes[".uvvt"] = "application/vnd.dece.ttml+xml";
	mimeTypes[".uvvu"] = "video/vnd.uvvu.mp4";
	mimeTypes[".uvvv"] = "video/vnd.dece.video";
	mimeTypes[".uvvx"] = "application/vnd.dece.unspecified";
	mimeTypes[".uvvz"] = "application/vnd.dece.zip";
	mimeTypes[".uvx"] = "application/vnd.dece.unspecified";
	mimeTypes[".uvz"] = "application/vnd.dece.zip";
	mimeTypes[".vcard"] = "text/vcard";
	mimeTypes[".vcd"] = "application/x-cdlink";
	mimeTypes[".vcf"] = "text/x-vcard";
	mimeTypes[".vcg"] = "application/vnd.groove-vcard";
	mimeTypes[".vcs"] = "text/x-vcalendar";
	mimeTypes[".vcx"] = "application/vnd.vcx";
	mimeTypes[".vis"] = "application/vnd.visionary";
	mimeTypes[".viv"] = "video/vnd.vivo";
	mimeTypes[".vob"] = "video/x-ms-vob";
	mimeTypes[".vor"] = "application/vnd.stardivision.writer";
	mimeTypes[".vox"] = "application/x-authorware-bin";
	mimeTypes[".vrml"] = "model/vrml";
	mimeTypes[".vsd"] = "application/vnd.visio";
	mimeTypes[".vsf"] = "application/vnd.vsf";
	mimeTypes[".vss"] = "application/vnd.visio";
	mimeTypes[".vst"] = "application/vnd.visio";
	mimeTypes[".vsw"] = "application/vnd.visio";
	mimeTypes[".vtt"] = "text/vtt";
	mimeTypes[".vtu"] = "model/vnd.vtu";
	mimeTypes[".vxml"] = "application/voicexml+xml";
	mimeTypes[".w3d"] = "application/x-director";
	mimeTypes[".wad"] = "application/x-doom";
	mimeTypes[".wasm"] = "application/wasm";
	mimeTypes[".wav"] = "audio/x-wav";
	mimeTypes[".wax"] = "audio/x-ms-wax";
	mimeTypes[".wbmp"] = "image/vnd.wap.wbmp";
	mimeTypes[".wbs"] = "application/vnd.criticaltools.wbs+xml";
	mimeTypes[".wbxml"] = "application/vnd.wap.wbxml";
	mimeTypes[".wcm"] = "application/vnd.ms-works";
	mimeTypes[".wdb"] = "application/vnd.ms-works";
	mimeTypes[".wdp"] = "image/vnd.ms-photo";
	mimeTypes[".weba"] = "audio/webm";
	mimeTypes[".webm"] = "video/webm";
	mimeTypes[".webmanifest"] = "application/manifest+json";
	mimeTypes[".webp"] = "image/webp";
	mimeTypes[".wg"] = "application/vnd.pmi.widget";
	mimeTypes[".wgt"] = "application/widget";
	mimeTypes[".wiz"] = "application/msword";
	mimeTypes[".wks"] = "application/vnd.ms-works";
	mimeTypes[".wm"] = "video/x-ms-wm";
	mimeTypes[".wma"] = "audio/x-ms-wma";
	mimeTypes[".wmd"] = "application/x-ms-wmd";
	mimeTypes[".wmf"] = "application/x-msmetafile";
	mimeTypes[".wml"] = "text/vnd.wap.wml";
	mimeTypes[".wmlc"] = "application/vnd.wap.wmlc";
	mimeTypes[".wmls"] = "text/vnd.wap.wmlscript";
	mimeTypes[".wmlsc"] = "application/vnd.wap.wmlscriptc";
	mimeTypes[".wmv"] = "video/x-ms-wmv";
	mimeTypes[".wmx"] = "video/x-ms-wmx";
	mimeTypes[".wmz"] = "application/x-msmetafile";
	mimeTypes[".woff"] = "font/woff";
	mimeTypes[".woff2"] = "font/woff2";
	mimeTypes[".wpd"] = "application/vnd.wordperfect";
	mimeTypes[".wpl"] = "application/vnd.ms-wpl";
	mimeTypes[".wps"] = "application/vnd.ms-works";
	mimeTypes[".wqd"] = "application/vnd.wqd";
	mimeTypes[".wri"] = "application/x-mswrite";
	mimeTypes[".wrl"] = "model/vrml";
	mimeTypes[".wsdl"] = "application/wsdl+xml";
	mimeTypes[".wspolicy"] = "application/wspolicy+xml";
	mimeTypes[".wtb"] = "application/vnd.webturbo";
	mimeTypes[".wvx"] = "video/x-ms-wvx";
	mimeTypes[".x32"] = "application/x-authorware-bin";
	mimeTypes[".x3d"] = "model/x3d+xml";
	mimeTypes[".x3db"] = "model/x3d+binary";
	mimeTypes[".x3dbz"] = "model/x3d+binary";
	mimeTypes[".x3dv"] = "model/x3d+vrml";
	mimeTypes[".x3dvz"] = "model/x3d+vrml";
	mimeTypes[".x3dz"] = "model/x3d+xml";
	mimeTypes[".xaml"] = "application/xaml+xml";
	mimeTypes[".xap"] = "application/x-silverlight-app";
	mimeTypes[".xar"] = "application/vnd.xara";
	mimeTypes[".xbap"] = "application/x-ms-xbap";
	mimeTypes[".xbd"] = "application/vnd.fujixerox.docuworks.binder";
	mimeTypes[".xbm"] = "image/x-xbitmap";
	mimeTypes[".xdf"] = "application/xcap-diff+xml";
	mimeTypes[".xdm"] = "application/vnd.syncml.dm+xml";
	mimeTypes[".xdp"] = "application/vnd.adobe.xdp+xml";
	mimeTypes[".xdssc"] = "application/dssc+xml";
	mimeTypes[".xdw"] = "application/vnd.fujixerox.docuworks";
	mimeTypes[".xenc"] = "application/xenc+xml";
	mimeTypes[".xer"] = "application/patch-ops-error+xml";
	mimeTypes[".xfdf"] = "application/vnd.adobe.xfdf";
	mimeTypes[".xfdl"] = "application/vnd.xfdl";
	mimeTypes[".xht"] = "application/xhtml+xml";
	mimeTypes[".xhtml"] = "application/xhtml+xml";
	mimeTypes[".xhvml"] = "application/xv+xml";
	mimeTypes[".xif"] = "image/vnd.xiff";
	mimeTypes[".xla"] = "application/vnd.ms-excel";
	mimeTypes[".xlam"] = "application/vnd.ms-excel.addin.macroenabled.12";
	mimeTypes[".xlb"] = "application/vnd.ms-excel";
	mimeTypes[".xlc"] = "application/vnd.ms-excel";
	mimeTypes[".xlf"] = "application/x-xliff+xml";
	mimeTypes[".xlm"] = "application/vnd.ms-excel";
	mimeTypes[".xls"] = "application/vnd.ms-excel";
	mimeTypes[".xlsb"] = "application/vnd.ms-excel.sheet.binary.macroenabled.12";
	mimeTypes[".xlsm"] = "application/vnd.ms-excel.sheet.macroenabled.12";
	mimeTypes[".xlsx"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
	mimeTypes[".xlt"] = "application/vnd.ms-excel";
	mimeTypes[".xltm"] = "application/vnd.ms-excel.template.macroenabled.12";
	mimeTypes[".xltx"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.template";
	mimeTypes[".xlw"] = "application/vnd.ms-excel";
	mimeTypes[".xm"] = "audio/xm";
	mimeTypes[".xml"] = "application/xml";
	mimeTypes[".xo"] = "application/vnd.olpc-sugar";
	mimeTypes[".xop"] = "application/xop+xml";
	mimeTypes[".xpdl"] = "application/xml";
	mimeTypes[".xpi"] = "application/x-xpinstall";
	mimeTypes[".xpl"] = "application/xproc+xml";
	mimeTypes[".xpm"] = "image/x-xpixmap";
	mimeTypes[".xpr"] = "application/vnd.is-xpr";
	mimeTypes[".xps"] = "application/vnd.ms-xpsdocument";
	mimeTypes[".xpw"] = "application/vnd.intercon.formnet";
	mimeTypes[".xpx"] = "application/vnd.intercon.formnet";
	mimeTypes[".xsl"] = "application/xml";
	mimeTypes[".xslt"] = "application/xslt+xml";
	mimeTypes[".xsm"] = "application/vnd.syncml+xml";
	mimeTypes[".xspf"] = "application/xspf+xml";
	mimeTypes[".xul"] = "application/vnd.mozilla.xul+xml";
	mimeTypes[".xvm"] = "application/xv+xml";
	mimeTypes[".xvml"] = "application/xv+xml";
	mimeTypes[".xwd"] = "image/x-xwindowdump";
	mimeTypes[".xyz"] = "chemical/x-xyz";
	mimeTypes[".xz"] = "application/x-xz";
	mimeTypes[".yang"] = "application/yang";
	mimeTypes[".yin"] = "application/yin+xml";
	mimeTypes[".z1"] = "application/x-zmachine";
	mimeTypes[".z2"] = "application/x-zmachine";
	mimeTypes[".z3"] = "application/x-zmachine";
	mimeTypes[".z4"] = "application/x-zmachine";
	mimeTypes[".z5"] = "application/x-zmachine";
	mimeTypes[".z6"] = "application/x-zmachine";
	mimeTypes[".z7"] = "application/x-zmachine";
	mimeTypes[".z8"] = "application/x-zmachine";
	mimeTypes[".zaz"] = "application/vnd.zzazz.deck+xml";
	mimeTypes[".zip"] = "application/zip";
	mimeTypes[".zir"] = "application/vnd.zul";
	mimeTypes[".zirz"] = "application/vnd.zul";
	mimeTypes[".zmm"] = "application/vnd.handheld-entertainment+xml";
}

/*
Check the method is allowed for the location
*/
bool Server::isAllowed(string directory, string method)
{
	map<string, Location>::const_iterator location = config.getLocations().find(directory);
	if (location != config.getLocations().end())
	{
		const vector<string> allowed = location->second.getAllowedMethods();
		for (vector<string>::const_iterator it = allowed.begin(); it != allowed.end(); it++)
		{
			if (method == *it)
				return true;
		}
		return false;
	}
	return "GET" == method;
}

/*
Gets the new location for a redirect
*/
string Server::redirPath(string directory) const
{
	map<string, Location>::const_iterator location = config.getLocations().find(directory);
	if (location != config.getLocations().end())
		return location->second.getRedirPath();
	return "";
}

bool Server::isListing(string directory) const
{
	map<string, Location>::const_iterator listing = config.getLocations().find(directory);
	if (listing != config.getLocations().end())
		return listing->second.getAutoindex();
	return false;
}

string Server::mimeType(string extension) const
{
	map<string, string>::const_iterator mimeType = mimeTypes.find(extension);
	if (mimeType != mimeTypes.end())
		return mimeType->second;

	return "text/html";
}

string Server::statusCode(int code) const
{
	return statusCodes.at(code);
}

string Server::uploadPath(string location) const
{
	return config.getUploadPath(location);
}

bool Server::validCGI(string extension, string directory) const
{		
	map<string, Location>::const_iterator location = config.getLocations().find(directory);
	if (location != config.getLocations().end())
	{
		vector<string> extensions = location->second.getCgiExtensions();
		for (vector<string>::iterator it = extensions.begin(); it != extensions.end(); it++)
			if (*it == extension)
				return true;
	}
	return false;
}

// Getters
const ServerConfig &Server::getConfig() const { return config; }
const int &Server::getListenFD() const { return listenFD; }
const int &Server::getMaxClientBodySize() const { return config.getMaxClientBodySize(); }
const string &Server::getRootDir() const { return config.getRootDir(); }

// Setters
void Server::setConfig(ServerConfig newConfig) { config = newConfig; }

ostream	&operator<<(ostream &stream, Server const &server)
{
	stream << "Server:" << endl
		<< server.getConfig() << endl;

	return stream;
}
